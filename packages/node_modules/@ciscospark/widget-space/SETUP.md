# Space Widget Setup Flow

The Space Widget allows you to open a space to a given space id, person id, or person email.

The widget goes through different workflows depending on which type of space you are opening.

## Destinations

The Space Widget requires two identifiers for the space: destination id and destination type.

### Destination Type

Destination type determines what kind of space you are trying to open. It can be one of three values:

* "email"
* "personId"
* "spaceId"

### Destination Id

If destination type is "email", then simply pass a string containing the email of the user you would like to open the space with.

If the destination type is either "personId" or "spaceId", you can pass the UUID or the Hydra ID (the ID provided by the developer portal).

## Legacy Properties

Previously, the space widget accepted different properties for different destination types, but in an attempt to consolidate, those properties are now deprecated and need to be migrated to the following:

* "spaceId" should now be `destinationType: "spaceId"` and `destinationId: {spaceId}`
* "toPersonId" should now be `destinationType: "personId"` and `destinationId: {toPersonId}`
* "email" should now be `destinationType: "email"` and `destinationId: {email}`

## Processing

When the widget initializes, it processes the destination to understand which "conversation" to load from the API.

### Space ID

The "spaceId" destination type is the most straightforward space for processing.
The "destinationId" is converted from a hydra ID to a UUID (if necessary), then the conversation details are fetched from the `/rooms` endpoint with the UUID.

### Email/Person ID

The "email" destination type allows a user to open a direct space to the account with the given email address. The space widget uses the conversation service to get space details for direct spaces. This is due to the fact that the `/rooms` endpoint doesn't currently have a way to look up space details without a room id.